<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renergy4all - Exemple d'intégration</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }
        
        .loading::after {
            content: "";
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 py-4 flex items-center justify-between">
            <h1 class="text-2xl font-bold text-purple-600">Renergy4all</h1>
            <div class="space-x-6">
                <a href="#services" class="text-gray-600 hover:text-purple-600">Services</a>
                <a href="#projects" class="text-gray-600 hover:text-purple-600">Projets</a>
                <a href="#blog" class="text-gray-600 hover:text-purple-600">Blog</a>
                <a href="#contact" class="text-gray-600 hover:text-purple-600">Contact</a>
            </div>
        </nav>
    </header>
    
    <!-- Hero Section -->
    <section id="hero" class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-20">
        <div class="container mx-auto px-4 text-center">
            <h1 id="hero-title" class="text-5xl font-bold mb-6">Chargement...</h1>
            <p id="hero-subtitle" class="text-xl mb-8 opacity-90">Chargement...</p>
            <a href="#services" id="hero-cta" class="inline-block bg-white text-purple-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">
                Découvrir
            </a>
        </div>
    </section>
    
    <!-- Statistiques -->
    <section id="stats" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                <div class="p-6">
                    <div class="text-5xl font-bold text-purple-600 mb-2">
                        <span id="years-experience">-</span>+
                    </div>
                    <p class="text-gray-600">Années d'expérience</p>
                </div>
                <div class="p-6">
                    <div class="text-5xl font-bold text-purple-600 mb-2">
                        <span id="countries-covered">-</span>
                    </div>
                    <p class="text-gray-600">Pays couverts</p>
                </div>
                <div class="p-6">
                    <div class="text-5xl font-bold text-purple-600 mb-2">
                        <span id="installations-completed">-</span>+
                    </div>
                    <p class="text-gray-600">Installations réalisées</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Services -->
    <section id="services" class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-gray-800 mb-4">Nos Services</h2>
                <p class="text-xl text-gray-600">Solutions solaires adaptées à vos besoins</p>
            </div>
            <div id="services-container" class="loading grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Services chargés dynamiquement -->
            </div>
        </div>
    </section>
    
    <!-- Projets -->
    <section id="projects" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-gray-800 mb-4">Nos Projets</h2>
                <p class="text-xl text-gray-600">Découvrez nos réalisations à travers l'Afrique</p>
            </div>
            <div id="projects-container" class="loading grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Projets chargés dynamiquement -->
            </div>
        </div>
    </section>
    
    <!-- Valeurs -->
    <section id="values" class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-gray-800 mb-4">Nos Valeurs</h2>
                <p class="text-xl text-gray-600">Ce qui nous guide au quotidien</p>
            </div>
            <div id="values-container" class="loading grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Valeurs chargées dynamiquement -->
            </div>
        </div>
    </section>
    
    <!-- Blog -->
    <section id="blog" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-gray-800 mb-4">Actualités</h2>
                <p class="text-xl text-gray-600">Restez informés de nos dernières nouvelles</p>
            </div>
            <div id="blog-container" class="loading grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Articles chargés dynamiquement -->
            </div>
        </div>
    </section>
    
    <!-- Contact -->
    <section id="contact" class="py-16 bg-gradient-to-r from-purple-600 to-indigo-600 text-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold mb-4">Contactez-nous</h2>
                <p class="text-xl opacity-90">Nous sommes à votre écoute</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-4xl mx-auto">
                <!-- Informations de contact -->
                <div class="space-y-6">
                    <h3 class="text-2xl font-bold mb-6">Nos coordonnées</h3>
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-envelope text-2xl"></i>
                        <span id="contact-email">-</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-phone text-2xl"></i>
                        <span id="contact-phone">-</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-map-marker-alt text-2xl"></i>
                        <span id="contact-address">-</span>
                    </div>
                </div>
                
                <!-- Formulaire de contact -->
                <div>
                    <h3 class="text-2xl font-bold mb-6">Envoyez-nous un message</h3>
                    <form id="contact-form" class="space-y-4">
                        <input type="text" name="name" placeholder="Votre nom" required
                               class="w-full px-4 py-3 rounded-lg text-gray-800 focus:ring-2 focus:ring-white">
                        <input type="email" name="email" placeholder="Votre email" required
                               class="w-full px-4 py-3 rounded-lg text-gray-800 focus:ring-2 focus:ring-white">
                        <input type="tel" name="phone" placeholder="Votre téléphone"
                               class="w-full px-4 py-3 rounded-lg text-gray-800 focus:ring-2 focus:ring-white">
                        <input type="text" name="subject" placeholder="Sujet"
                               class="w-full px-4 py-3 rounded-lg text-gray-800 focus:ring-2 focus:ring-white">
                        <textarea name="message" rows="4" placeholder="Votre message" required
                                  class="w-full px-4 py-3 rounded-lg text-gray-800 focus:ring-2 focus:ring-white"></textarea>
                        <button type="submit" 
                                class="w-full bg-white text-purple-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">
                            Envoyer le message
                        </button>
                    </form>
                    <div id="form-message" class="mt-4"></div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2025 Renergy4all. Tous droits réservés.</p>
        </div>
    </footer>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script>
        // IMPORTANT: Remplacez cette URL par votre URL de backoffice déployé
        // const API_URL = 'https://renergy-backoffice.pages.dev/api';
        const API_URL = 'http://localhost:3000/api'; // Pour le test local
        
        // Fonction principale pour charger toutes les données
        async function loadData() {
            try {
                const [services, projects, blog, config, hero, values] = await Promise.all([
                    axios.get(`${API_URL}/services`),
                    axios.get(`${API_URL}/projects`),
                    axios.get(`${API_URL}/blog`),
                    axios.get(`${API_URL}/config`),
                    axios.get(`${API_URL}/config/hero`),
                    axios.get(`${API_URL}/values`)
                ]);
                
                updateHeroSection(hero.data.hero);
                updateServices(services.data.services);
                updateProjects(projects.data.projects);
                updateBlog(blog.data.posts);
                updateValues(values.data.values);
                updateConfig(config.data.config);
                
            } catch (error) {
                console.error('Erreur de chargement:', error);
                alert('Erreur de chargement des données. Vérifiez la console.');
            }
        }
        
        function updateHeroSection(hero) {
            if (!hero) return;
            document.getElementById('hero-title').textContent = hero.title;
            document.getElementById('hero-subtitle').textContent = hero.subtitle || '';
            const heroCTA = document.getElementById('hero-cta');
            if (hero.cta_text) heroCTA.textContent = hero.cta_text;
            if (hero.cta_url) heroCTA.href = hero.cta_url;
        }
        
        function updateServices(services) {
            const container = document.getElementById('services-container');
            container.classList.remove('loading');
            container.innerHTML = services.map(service => `
                <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition">
                    <div class="w-16 h-16 bg-purple-100 rounded-lg flex items-center justify-center mb-4 mx-auto">
                        <i class="${service.icon || 'fas fa-cog'} text-3xl text-purple-600"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-3 text-center">${service.title}</h3>
                    <p class="text-gray-600 text-center">${service.description || ''}</p>
                </div>
            `).join('');
        }
        
        function updateProjects(projects) {
            const container = document.getElementById('projects-container');
            container.classList.remove('loading');
            container.innerHTML = projects.map(project => `
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition">
                    ${project.image_url ? `<img src="${project.image_url}" alt="${project.title}" class="w-full h-48 object-cover">` : ''}
                    <div class="p-6">
                        <span class="px-3 py-1 text-xs font-semibold rounded-full ${project.status === 'complete' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}">
                            ${project.status === 'complete' ? 'Terminé' : 'En cours'}
                        </span>
                        <h3 class="text-xl font-bold text-gray-800 mt-3 mb-2">${project.title}</h3>
                        <p class="text-gray-600 mb-4">${project.summary || ''}</p>
                        <div class="space-y-2 text-sm text-gray-500">
                            <div><i class="fas fa-map-marker-alt mr-2"></i>${project.city || ''}, ${project.country || ''}</div>
                            ${project.capacity_kw ? `<div><i class="fas fa-bolt mr-2"></i>${project.capacity_kw} kW</div>` : ''}
                            ${project.beneficiaries ? `<div><i class="fas fa-users mr-2"></i>${project.beneficiaries} bénéficiaires</div>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function updateBlog(posts) {
            const container = document.getElementById('blog-container');
            container.classList.remove('loading');
            container.innerHTML = posts.slice(0, 3).map(post => `
                <article class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition">
                    ${post.image_url ? `<img src="${post.image_url}" alt="${post.title}" class="w-full h-48 object-cover">` : ''}
                    <div class="p-6">
                        <span class="text-sm text-purple-600 font-semibold">${post.category || 'Actualités'}</span>
                        <h3 class="text-xl font-bold text-gray-800 mt-2 mb-3">${post.title}</h3>
                        <p class="text-gray-600 mb-4">${post.excerpt || ''}</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span><i class="fas fa-user mr-1"></i>${post.author || 'Renergy4all'}</span>
                            <span><i class="fas fa-calendar mr-1"></i>${post.published_at ? new Date(post.published_at).toLocaleDateString('fr-FR') : ''}</span>
                        </div>
                        <a href="#" class="text-purple-600 font-semibold hover:text-purple-700">Lire la suite →</a>
                    </div>
                </article>
            `).join('');
        }
        
        function updateValues(values) {
            const container = document.getElementById('values-container');
            container.classList.remove('loading');
            container.innerHTML = values.map(value => `
                <div class="bg-white rounded-xl shadow-md p-8 text-center hover:shadow-xl transition">
                    <div class="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i class="${value.icon || 'fas fa-star'} text-4xl text-purple-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">${value.title}</h3>
                    ${value.subtitle ? `<h4 class="text-lg text-gray-600 mb-4">${value.subtitle}</h4>` : ''}
                    <p class="text-gray-600">${value.description || ''}</p>
                </div>
            `).join('');
        }
        
        function updateConfig(config) {
            document.getElementById('years-experience').textContent = config.years_experience || '0';
            document.getElementById('countries-covered').textContent = config.countries_covered || '0';
            document.getElementById('installations-completed').textContent = config.installations_completed || '0';
            document.getElementById('contact-email').textContent = config.contact_email || '-';
            document.getElementById('contact-phone').textContent = config.contact_phone || '-';
            document.getElementById('contact-address').textContent = config.contact_address || '-';
        }
        
        // Gestion du formulaire de contact
        document.getElementById('contact-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = {
                name: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                subject: formData.get('subject'),
                message: formData.get('message')
            };
            
            const messageDiv = document.getElementById('form-message');
            
            try {
                const response = await axios.post(`${API_URL}/contact`, data);
                
                if (response.data.success) {
                    messageDiv.innerHTML = '<div class="bg-green-100 text-green-800 px-4 py-3 rounded-lg">✓ Message envoyé avec succès !</div>';
                    e.target.reset();
                    
                    setTimeout(() => {
                        messageDiv.innerHTML = '';
                    }, 5000);
                }
            } catch (error) {
                messageDiv.innerHTML = '<div class="bg-red-100 text-red-800 px-4 py-3 rounded-lg">✗ Erreur lors de l\'envoi. Veuillez réessayer.</div>';
                console.error('Erreur:', error);
            }
        });
        
        // Charger les données au chargement de la page
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>
